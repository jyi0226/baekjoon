#include <iostream>
#include <string>
using namespace std;

char u[4][4], d[4][4], f[4][4], b[4][4], r[4][4], l[4][4];

int t;
int n;
string st;

int main()
{
    ios::sync_with_stdio(false);
    cin.tie(NULL);
    cout.tie(NULL);

    cin >> t;
    while (t--)
    {
        for (int i = 1; i <= 3; i++)
        {
            for (int j = 1; j <= 3; j++)
            {
                u[i][j] = 'w';
                d[i][j] = 'y';
                f[i][j] = 'r';
                b[i][j] = 'o';
                l[i][j] = 'g';
                r[i][j] = 'b';
            }
        }
        cin >> n;
        for (int i = 0; i < n; i++)
        {
            cin >> st;
            if (st == "U+")
            {
                char v1 = u[1][1];
                char v2 = u[1][2];
                char v3 = u[1][3];

                u[1][1] = u[3][1];
                u[1][2] = u[2][1];
                u[1][3] = v1;
                u[2][1] = u[3][2];
                u[3][1] = u[3][3];
                u[3][2] = u[2][3];
                u[3][3] = v3;
                u[2][3] = v2;

                v1 = l[1][1];
                v2 = l[1][2];
                v3 = l[1][3];

                l[1][1] = f[1][1];
                l[1][2] = f[1][2];
                l[1][3] = f[1][3];
                f[1][1] = r[1][1];
                f[1][2] = r[1][2];
                f[1][3] = r[1][3];
                r[1][1] = b[1][1];
                r[1][2] = b[1][2];
                r[1][3] = b[1][3];
                b[1][1] = v1;
                b[1][2] = v2;
                b[1][3] = v3;
            }
            else if (st == "U-")
            {
                char v1 = u[1][1];
                char v2 = u[1][2];
                char v3 = u[1][3];

                u[1][1] = v3;
                u[1][2] = u[2][3];
                u[1][3] = u[3][3];
                u[2][3] = u[3][2];
                u[3][3] = u[3][1];
                u[3][2] = u[2][1];
                u[3][1] = v1;
                u[2][1] = v2;

                v1 = l[1][1];
                v2 = l[1][2];
                v3 = l[1][3];

                l[1][1] = b[1][1];
                l[1][2] = b[1][2];
                l[1][3] = b[1][3];
                b[1][1] = r[1][1];
                b[1][2] = r[1][2];
                b[1][3] = r[1][3];
                r[1][1] = f[1][1];
                r[1][2] = f[1][2];
                r[1][3] = f[1][3];
                f[1][1] = v1;
                f[1][2] = v2;
                f[1][3] = v3;
            }
            else if (st == "D+")
            {
                char v1 = d[1][1];
                char v2 = d[1][2];
                char v3 = d[1][3];

                d[1][1] = d[3][1];
                d[1][2] = d[2][1];
                d[1][3] = v1;
                d[2][1] = d[3][2];
                d[3][1] = d[3][3];
                d[3][2] = d[2][3];
                d[3][3] = v3;
                d[2][3] = v2;

                v1 = l[3][1];
                v2 = l[3][2];
                v3 = l[3][3];

                l[3][1] = b[3][1];
                l[3][2] = b[3][2];
                l[3][3] = b[3][3];
                b[3][1] = r[3][1];
                b[3][2] = r[3][2];
                b[3][3] = r[3][3];
                r[3][1] = f[3][1];
                r[3][2] = f[3][2];
                r[3][3] = f[3][3];
                f[3][1] = v1;
                f[3][2] = v2;
                f[3][3] = v3;
            }
            else if (st == "D-")
            {
                char v1 = d[1][1];
                char v2 = d[1][2];
                char v3 = d[1][3];

                d[1][1] = v3;
                d[1][2] = d[2][3];
                d[1][3] = d[3][3];
                d[2][3] = d[3][2];
                d[3][3] = d[3][1];
                d[3][2] = d[2][1];
                d[3][1] = v1;
                d[2][1] = v2;

                v1 = l[3][1];
                v2 = l[3][2];
                v3 = l[3][3];

                l[3][1] = f[3][1];
                l[3][2] = f[3][2];
                l[3][3] = f[3][3];
                f[3][1] = r[3][1];
                f[3][2] = r[3][2];
                f[3][3] = r[3][3];
                r[3][1] = b[3][1];
                r[3][2] = b[3][2];
                r[3][3] = b[3][3];
                b[3][1] = v1;
                b[3][2] = v2;
                b[3][3] = v3;
            }
            else if (st == "F+")
            {
                char v1 = f[1][1];
                char v2 = f[1][2];
                char v3 = f[1][3];

                f[1][1] = f[3][1];
                f[1][2] = f[2][1];
                f[1][3] = v1;
                f[2][1] = f[3][2];
                f[3][1] = f[3][3];
                f[3][2] = f[2][3];
                f[3][3] = v3;
                f[2][3] = v2;

                v1 = u[3][1];
                v2 = u[3][2];
                v3 = u[3][3];
                u[3][1] = l[3][3];
                u[3][2] = l[2][3];
                u[3][3] = l[1][3];
                l[3][3] = d[1][3];
                l[2][3] = d[1][2];
                l[1][3] = d[1][1];
                d[1][3] = r[1][1];
                d[1][2] = r[2][1];
                d[1][1] = r[3][1];
                r[1][1] = v1;
                r[2][1] = v2;
                r[3][1] = v3;
            }
            else if (st == "F-")
            {
                char v1 = f[1][1];
                char v2 = f[1][2];
                char v3 = f[1][3];

                f[1][1] = v3;
                f[1][2] = f[2][3];
                f[1][3] = f[3][3];
                f[2][3] = f[3][2];
                f[3][3] = f[3][1];
                f[3][2] = f[2][1];
                f[3][1] = v1;
                f[2][1] = v2;

                v1 = u[3][1];
                v2 = u[3][2];
                v3 = u[3][3];
                u[3][1] = r[1][1];
                u[3][2] = r[2][1];
                u[3][3] = r[3][1];
                r[1][1] = d[1][3];
                r[2][1] = d[1][2];
                r[3][1] = d[1][1];
                d[1][3] = l[3][3];
                d[1][2] = l[2][3];
                d[1][1] = l[1][3];
                l[3][3] = v1;
                l[2][3] = v2;
                l[1][3] = v3;
            }
            else if (st == "B+")
            {
                char v1 = b[1][1];
                char v2 = b[1][2];
                char v3 = b[1][3];

                b[1][1] = b[3][1];
                b[1][2] = b[2][1];
                b[1][3] = v1;
                b[2][1] = b[3][2];
                b[3][1] = b[3][3];
                b[3][2] = b[2][3];
                b[3][3] = v3;
                b[2][3] = v2;

                v1 = u[1][1];
                v2 = u[1][2];
                v3 = u[1][3];
                u[1][1] = r[1][3];
                u[1][2] = r[2][3];
                u[1][3] = r[3][3];
                r[1][3] = d[3][3];
                r[2][3] = d[3][2];
                r[3][3] = d[3][1];
                d[3][3] = l[3][1];
                d[3][2] = l[2][1];
                d[3][1] = l[1][1];
                l[3][1] = v1;
                l[2][1] = v2;
                l[1][1] = v3;
            }
            else if (st == "B-")
            {
                char v1 = b[1][1];
                char v2 = b[1][2];
                char v3 = b[1][3];

                b[1][1] = v3;
                b[1][2] = b[2][3];
                b[1][3] = b[3][3];
                b[2][3] = b[3][2];
                b[3][3] = b[3][1];
                b[3][2] = b[2][1];
                b[3][1] = v1;
                b[2][1] = v2;

                v1 = u[1][1];
                v2 = u[1][2];
                v3 = u[1][3];
                u[1][1] = l[3][1];
                u[1][2] = l[2][1];
                u[1][3] = l[1][1];
                l[3][1] = d[3][3];
                l[2][1] = d[3][2];
                l[1][1] = d[3][1];
                d[3][3] = r[1][3];
                d[3][2] = r[2][3];
                d[3][1] = r[3][3];
                r[1][3] = v1;
                r[2][3] = v2;
                r[3][3] = v3;
            }
            else if (st == "L+")
            {
                char v1 = l[1][1];
                char v2 = l[1][2];
                char v3 = l[1][3];

                l[1][1] = l[3][1];
                l[1][2] = l[2][1];
                l[1][3] = v1;
                l[2][1] = l[3][2];
                l[3][1] = l[3][3];
                l[3][2] = l[2][3];
                l[3][3] = v3;
                l[2][3] = v2;

                v1 = u[1][1];
                v2 = u[2][1];
                v3 = u[3][1];
                u[1][1] = b[3][3];
                u[2][1] = b[2][3];
                u[3][1] = b[1][3];
                b[3][3] = d[1][1];
                b[2][3] = d[2][1];
                b[1][3] = d[3][1];
                d[1][1] = f[1][1];
                d[2][1] = f[2][1];
                d[3][1] = f[3][1];
                f[1][1] = v1;
                f[2][1] = v2;
                f[3][1] = v3;
            }
            else if (st == "L-")
            {
                char v1 = l[1][1];
                char v2 = l[1][2];
                char v3 = l[1][3];

                l[1][1] = v3;
                l[1][2] = l[2][3];
                l[1][3] = l[3][3];
                l[2][3] = l[3][2];
                l[3][3] = l[3][1];
                l[3][2] = l[2][1];
                l[3][1] = v1;
                l[2][1] = v2;

                v1 = u[1][1];
                v2 = u[2][1];
                v3 = u[3][1];
                u[1][1] = f[1][1];
                u[2][1] = f[2][1];
                u[3][1] = f[3][1];
                f[1][1] = d[1][1];
                f[2][1] = d[2][1];
                f[3][1] = d[3][1];
                d[1][1] = b[3][3];
                d[2][1] = b[2][3];
                d[3][1] = b[1][3];
                b[3][3] = v1;
                b[2][3] = v2;
                b[1][3] = v3;
            }
            else if (st == "R+")
            {
                char v1 = r[1][1];
                char v2 = r[1][2];
                char v3 = r[1][3];

                r[1][1] = r[3][1];
                r[1][2] = r[2][1];
                r[1][3] = v1;
                r[2][1] = r[3][2];
                r[3][1] = r[3][3];
                r[3][2] = r[2][3];
                r[3][3] = v3;
                r[2][3] = v2;

                v1 = u[1][3];
                v2 = u[2][3];
                v3 = u[3][3];
                u[1][3] = f[1][3];
                u[2][3] = f[2][3];
                u[3][3] = f[3][3];
                f[1][3] = d[1][3];
                f[2][3] = d[2][3];
                f[3][3] = d[3][3];
                d[1][3] = b[3][1];
                d[2][3] = b[2][1];
                d[3][3] = b[1][1];
                b[3][1] = v1;
                b[2][1] = v2;
                b[1][1] = v3;
            }
            else if (st == "R-")
            {
                char v1 = r[1][1];
                char v2 = r[1][2];
                char v3 = r[1][3];

                r[1][1] = v3;
                r[1][2] = r[2][3];
                r[1][3] = r[3][3];
                r[2][3] = r[3][2];
                r[3][3] = r[3][1];
                r[3][2] = r[2][1];
                r[3][1] = v1;
                r[2][1] = v2;

                v1 = u[1][3];
                v2 = u[2][3];
                v3 = u[3][3];
                u[1][3] = b[3][1];
                u[2][3] = b[2][1];
                u[3][3] = b[1][1];
                b[3][1] = d[1][3];
                b[2][1] = d[2][3];
                b[1][1] = d[3][3];
                d[1][3] = f[1][3];
                d[2][3] = f[2][3];
                d[3][3] = f[3][3];
                f[1][3] = v1;
                f[2][3] = v2;
                f[3][3] = v3;
            }
        }
        for (int i = 1; i < 4; i++)
        {
            for (int j = 1; j < 4; j++)
                cout << u[i][j];
            cout << "\n";
        }
    }
}